<%= semantic_form_for(topic, builder: ActiveAdmin::FormBuilder) do |f| %>
  <%= f.fields_for :lessons, lesson do |l| %>
    <%= f.inputs "Duration", class: 'input duration' do %>
      <% l.input :duration_hours, as: :number, label: 'Hours' %>
      <% l.input :duration_minutes, as: :number, label: 'Minutes' %>
    <% end %>

    <%= f.inputs "Teaching Ratio", class: 'input ratio' do %>
      <% l.input :instructors, as: :number %>
      <% l.input :students, as: :number %>
    <% end %>

    <%= f.inputs do %>
      <% l.has_many :lesson_prereqs,
                 heading: false,
                 allow_destroy: true,
                 new_record: "Add a prerequisite" do |p| %>
        <% p.input :resource_type, as: :hidden,
                input_html: { value: "Lesson" } %>
        <% p.input :resource, as: :select,
                label: "Prerequisite", collection: Lesson.all %>
      <% end %>
    <% end %>

    <%= f.inputs do %>
      <% l.has_many :lesson_materials,
                 heading: false,
                 allow_destroy: true,
                 new_record: "Add a training material" do |p| %>
        <% p.input :resource_type, as: :hidden,
                input_html: { value: "Material" } %>
        <% p.input :resource, as: :select,
                label: "Material", collection: Material.all %>
      <% end %>
    <% end %>

    <%= f.inputs do %>
      <% l.has_many :lesson_articles,
                 heading: false,
                 allow_destroy: true,
                 new_record: "Add an article" do |p| %>
        <% p.input :resource_type, as: :hidden,
                input_html: { value: "Article" } %>
        <% p.input :resource, as: :select,
                label: "Article", collection: Article.all %>
      <% end %>
    <% end %>

    <%= f.inputs do %>
      <% l.input :tags,
            as: :select,
            multiple: true,
            collection: ActsAsTaggableOn::Tag.order(:name).select(:id, :name).all,
            input_html: { class: "select2" } %>
    <% end %>
  <% end %>

  <%= f.actions do %>
    <%= f.action :submit, label: "Update Lesson" %>
  <% end %>
<% end %>
