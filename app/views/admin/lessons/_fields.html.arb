f.fields_for :lessons, lesson do |l|
  if lesson.new_record?
    f.inputs do
      l.input :level_id, as: :select, required: true, collection: topic.lessons.unused_levels
    end
  end

  f.inputs "Duration", class: 'input duration' do
    l.fields_for :duration, l.object.duration do |d|
      d.input :hours, as: :number, label: 'Hours'
      d.input :minutes, as: :number, label: 'Minutes'
    end
  end

  f.inputs "Teaching Ratio", class: "input ratio" do
    l.input :instructor_students_ratio
  end

  unless lesson.persisted?
    lesson.objective ||= "Students will: <ul><li></li></ul>"
  end

  f.inputs do
    l.input :objective, as: :ckeditor
  end

  f.inputs do
    l.input :prerequisites, as: :ckeditor
  end

  f.inputs do
    unless lesson.persisted?
      lesson.required_materials ||= "<ul><li></li></ul>"
    end

    l.input :required_materials, as: :ckeditor
  end

  f.inputs do
    l.input :notes, as: :ckeditor, label: "Other Notes"
  end

  l.input :body, as: :ckeditor

  l.input :advice,
          input_html: { class: "select2", style: "width: 100%" }

  l.input :_destroy, as: :boolean, label: "Delete this level" if lesson.persisted?
end
